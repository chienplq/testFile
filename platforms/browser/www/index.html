<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>Blank App</title>
    </head>
    <body>
        <script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript">
		
		document.addEventListener("deviceready", onDeviceReady, false);
	window.addEventListener("batterystatus", onBatteryStatus, false);
    function onDeviceReady() {
			
			document.getElementById("loadFileAsText").onclick=loadFileAsText();
			
    }



	</script>
	<table>
 <tr><td>Text to Save:</td></tr>
 <tr>
  <td colspan="3">
   <textarea id="inputTextToSave" style="width:250px;height:125px"></textarea>
  </td>
 </tr>
  <tr>
  <td>Select a File to Load:</td>
  <td><input type="file" id="fileToLoad"></td>
  <td><button onclick="loadFileAsText()">Load Selected File</button><td>
 </tr>
 <tr>
  <td>Click to show pin</td>
  <td>--</td>
  <td><button onclick="showPin()">Show pin</button></button></td>
 </tr>
   <td>Click to save</td>
  <td>--</td>
  <td><button onclick="saveTextAsFile()">save</button></button></td>
 </tr>

</table>

<script type='text/javascript'>

 function saveTextAsFile() {  

    var textToWrite = document.getElementById("inputTextToSave").value;
    var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
    var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;
	
      var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    if (window.webkitURL != null)
    {
        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
    }
    else
    {

        downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
        downloadLink.onclick = destroyClickedElement;
        downloadLink.style.display = "none";
        document.body.appendChild(downloadLink);
    }

    downloadLink.click();
    }


	function showPin(status) {
	alert("asdsdasd");
    alert("Level: " + status.level + " isPlugged: " + status.isPlugged);
    }

    function loadFileAsText() {
        var fileToLoad = document.getElementById("fileToLoad").files[0];

        var fileReader = new FileReader();
        fileReader.onload = function (fileLoadedEvent) {
            var textFromFileLoaded = fileLoadedEvent.target.result;
            document.getElementById("inputTextToSave").value = textFromFileLoaded;
			alert(fileToLoad.toString());
        };
        fileReader.readAsText(fileToLoad, "UTF-8");
    }

</script>
	
    </body>
</html>
